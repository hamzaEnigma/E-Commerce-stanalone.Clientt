<div class="row">
    @let searchResult = filteredProducts$ | async;
    @let min = minPurchasePrice$ | async;
    @let max = maxPurchasePrice$ | async;
    <!-- Sidebar -->
    <div class="col-md-3">
        <!-- Search -->
        <div class="mb-4 bg-white border rounded search shadow-sm">
            <input type="text" [formControl]="searchProductFormControl" class="form-control"
                placeholder="Search products..." />
        </div>

        <!-- Filter by Price -->
        <div class="mb-4 p-3 bg-white border rounded  shadow-sm">
            <h5 class="mb-3">Filter by price</h5>
            <input type="range" class="form-range" [min]="0" [max]="max ?? 1000"
                [formControl]="filterPriceFormControl" />
            <div class="d-flex justify-content-between text-muted small">
                <span>{{0}} $</span>
                <span> {{ filterPriceFormControl.value ?? min }} $</span>
                <span>{{max}} $ </span>
            </div>
            <button class="btn btn-primary px-4  w-100" (click)="resetFilters()">Reset</button>
        </div>

        <!-- Filter by Category -->
        <div class="bg-white border rounded p-3 shadow-sm">
            <h5 class="mb-3">Filter by categories</h5>
            <ul class="list-unstyled mt-3">
                <li *ngFor="let item of categories">
                    <label class="text-muted">
                        <input type="radio" [value]="item.categoryName" [formControl]="filterCategoryFormControl"
                            class="form-check-input me-2" name="category" />
                        {{ item.categoryName }}
                    </label>
                </li>
                <li>
                    <label class="text-muted">
                        <input type="radio" value="" [formControl]="filterCategoryFormControl"
                            class="form-check-input me-2" name="category" />
                        All Categories
                    </label>
                </li>
            </ul>
        </div>

    </div>
    <!-- END Sidebar -->

    <!-- Products -->
    <div class="col-md-9 rounded">
        <div class="text-center py-5 loader-overlay" *ngIf="isLoading$ |async; else productsContent">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        <ng-template #productsContent>
            <div class="d-flex justify-content-between mb-3">
                <select class="form-select w-auto shadow-sm">
                    <option>Showing {{ searchResult?.length}} results</option>
                </select>
                <select class="form-select w-auto shadow-sm">
                    <option>Default sorting</option>
                </select>
            </div>
            <div class="row g-4">
                @for (item of searchResult; track $index) {
                <div class="col-md-4">
                    <div class="product-card">
                        <svg class="bd-placeholder-img card-img-top" width="100%" height="180"
                            xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Image"
                            preserveAspectRatio="xMidYMid slice" focusable="false">
                            <title>Placeholder</title>
                            <rect width="100%" height="100%" fill="#cccccc"></rect>
                            <text x="50%" y="50%" fill="#666" dy=".3em" text-anchor="middle">Image</text>
                        </svg>
                        <p class="name-product">{{item.productName}} ....</p>
                        <span class="category">{{item.category?.categoryName}}</span>
                        <div class="rating">
                            <span>4,2 ★★★★☆</span>
                            <span class="votes">(2,1 k)</span>
                        </div>
                        <p class="sales">Plus de 700 achetés au cours du mois dernier</p>
                        <div class="price">{{item.purchasePrice}}<sup>99</sup> €</div>
                        <div class="delivery">Livraison GRATUITE <b>21 - 24 juil.</b></div>
                        <button class="btn btn-primary">Ajouter au panier</button>
                    </div>
                </div>

                }

            </div>
        </ng-template>
    </div>
</div>